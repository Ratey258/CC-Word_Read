/**
 * Editor 组件样式
 * Word 文档编辑区样式
 */

/* ========== 文档容器 ========== */

.document-container
{
  position: fixed;
  top: calc(var(--titlebar-height) + var(--ribbon-total-height));
  bottom: var(--statusbar-height);
  left: 0;
  right: 0;
  background-color: #E7E7E7;
  overflow-y: auto;
  overflow-x: hidden;
  display: flex;
  justify-content: center;
  padding: 60px 20px;
}

/* ========== 文档页面 ========== */

.document-page
{
  width: 21cm; /* A4 宽度 */
  /* min-height 由 Vue 动态设置，确保能容纳多页内容 */
  background-color: var(--word-white);
  padding: 2.54cm; /* 默认页边距 */
  margin-bottom: 20px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1), 0 0 1px rgba(0, 0, 0, 0.1);
  position: relative;
  /* 自动扩展以适应内容 */
  height: auto;
}

.document-page:last-child
{
  margin-bottom: 0;
}

/* ========== 文档内容 ========== */

.document-content
{
  width: 100%;
  /* min-height 由 Vue 动态设置，确保能容纳多页内容 */
  font-family: var(--font-family-document);
  font-size: 14pt;
  line-height: 1.6;
  color: var(--word-text-primary);
  outline: none;
  border: none;
  resize: none;
  overflow: visible;
  white-space: pre-wrap;
  word-wrap: break-word;
  /* 自动扩展高度以适应所有内容 */
  height: auto;
}

.document-content[contenteditable="true"]
{
  cursor: text;
  user-select: text;
  -webkit-user-select: text;
}

.document-content[contenteditable="true"]:focus
{
  outline: none;
}

/* 光标样式 */
.document-content::selection
{
  background-color: var(--word-blue-light);
}

/* 空文档提示 */
.document-content:empty::before
{
  content: attr(data-placeholder);
  color: var(--word-text-disabled);
  font-style: italic;
  pointer-events: none;
}

/* ========== 页面标记（可选） ========== */

/* 为编辑器内容添加页面分隔线标记 */
.document-content[data-show-page-marks="true"]
{
  /* 使用重复的线性渐变创建页面分隔线 */
  background-image: repeating-linear-gradient(
    transparent,
    transparent calc(24.62cm - 1px),
    #e0e0e0 calc(24.62cm - 1px),
    #e0e0e0 24.62cm
  );
  background-attachment: local;
  background-position: 0 0;
}

/* 页面标记提示文字 */
/* 预留给未来可能的页码标记 */

/* ========== 响应式 ========== */

@media (max-width: 1400px)
{
  .document-container
  {
    padding: 40px 10px;
  }
}

@media (max-width: 900px)
{
  .document-page
  {
    width: 100%;
    min-height: auto;
    padding: 1cm;
    margin: 0;
    box-shadow: none;
  }
  
  .document-container
  {
    padding: 10px;
  }
}

/* ========== 打印样式 ========== */

@media print
{
  .document-container
  {
    position: static;
    background: white;
  }
  
  .document-page
  {
    margin: 0;
    box-shadow: none;
    page-break-after: always;
  }
  
  .document-page:last-child
  {
    page-break-after: auto;
  }
}
